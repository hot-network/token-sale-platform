import{N as m,l as h,u as f,r as i,j as e}from"./index-DmRFr9OQ.js";function g(a=m["mainnet-beta"].treasuryAddress,o,t,s,r="HOT Token Purchase",c="Thank you for your support!"){const n=new URL(`solana:${a}`);return n.searchParams.append("amount",o.toString()),t==="USDC"&&n.searchParams.append("spl-token",m["mainnet-beta"].usdcTokenMint),n.searchParams.append("reference",s),n.searchParams.append("label",r),n.searchParams.append("message",c),h.info("[SolanaPay]",`Generated URL: ${n.toString()}`),n.toString()}const x=a=>{const{transactions:o}=f(),[t,s]=i.useState("idle"),r=i.useMemo(()=>`hot_sale_${Date.now()}`,[]),c=i.useMemo(()=>g(void 0,a.amount,a.currency,r),[a.amount,a.currency,r]),n=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(c)}`;i.useEffect(()=>{let l;return t==="waiting"&&(l=window.setInterval(async()=>{s("verifying");try{await new Promise(d=>setTimeout(d,2e3)),console.log(`[SolanaPay] Found payment for reference: ${r}. Simulating success.`),await o.buyWithSolanaPay(a.hotAmount,a.currency),a.onSuccess()}catch(d){console.error("Verification failed:",d),s("waiting")}},5e3)),()=>{l&&window.clearInterval(l)}},[t,r,a.onSuccess,a.hotAmount,a.currency,o]);const u=()=>{s("waiting")};return t==="idle"?e.jsx("button",{onClick:u,className:"w-full bg-brand-accent text-brand-dark p-3 rounded-lg font-bold",children:"Generate Solana Pay QR Code"}):e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:c,target:"_blank",rel:"noopener noreferrer",children:e.jsx("img",{src:n,alt:"Solana Pay QR Code",className:"rounded-lg border-4 border-white dark:border-brand-dark-lighter shadow-lg"})}),e.jsxs("div",{className:"mt-4 text-center",children:[t==="waiting"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold",children:"Scan with your Solana wallet"}),e.jsx("p",{className:"text-sm text-gray-500 animate-pulse",children:"Waiting for payment..."})]}),t==="verifying"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold animate-pulse",children:"Verifying Transaction..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"This may take a moment."})]})]})]})};export{x as default};
